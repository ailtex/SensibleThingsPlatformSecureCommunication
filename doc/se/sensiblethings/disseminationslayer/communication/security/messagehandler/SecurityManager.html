<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_40) on Sun May 04 17:29:54 CEST 2014 -->
<title>SecurityManager</title>
<meta name="date" content="2014-05-04">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="SecurityManager";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/SecurityManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/MessageHandler.html" title="class in se.sensiblethings.disseminationslayer.communication.security.messagehandler"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html" target="_top">Frames</a></li>
<li><a href="SecurityManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">se.sensiblethings.disseminationslayer.communication.security.messagehandler</div>
<h2 title="Class SecurityManager" class="title">Class SecurityManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>se.sensiblethings.disseminationslayer.communication.security.messagehandler.SecurityManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">SecurityManager</span>
extends java.lang.Object</pre>
<div class="block">SecurityManager.java
 
 This class servers as middleware between up communication and below kinds of operations including key storing, 
 encryption, decryption and  signature signing and verifying.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>Hao</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/configuration/SecurityConfiguration.html" title="class in se.sensiblethings.disseminationslayer.communication.security.configuration">SecurityConfiguration</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#config">config</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/keystore/KeyStoreJCEKS.html" title="class in se.sensiblethings.disseminationslayer.communication.security.keystore">KeyStoreJCEKS</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#keyStore">keyStore</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#myUci">myUci</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.Map&lt;java.lang.String,java.lang.Object&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#noncePool">noncePool</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#SecurityManager(se.sensiblethings.disseminationslayer.communication.security.configuration.SecurityConfiguration)">SecurityManager</a></strong>(<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/configuration/SecurityConfiguration.html" title="class in se.sensiblethings.disseminationslayer.communication.security.configuration">SecurityConfiguration</a>&nbsp;config)</code>
<div class="block">Initialize the security manager</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#addToNoncePool(java.lang.String, java.lang.Object)">addToNoncePool</a></strong>(java.lang.String&nbsp;name,
              java.lang.Object&nbsp;value)</code>
<div class="block">Add the nonce to the temporary pool</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#asymmetricDecryptMessage(byte[], java.lang.String, char[])">asymmetricDecryptMessage</a></strong>(byte[]&nbsp;message,
                        java.lang.String&nbsp;algorithm,
                        char[]&nbsp;privateKeyPassword)</code>
<div class="block">Decrypt message with specified algorithm</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#asymmetricDecryptMessage(java.lang.String, java.lang.String, char[])">asymmetricDecryptMessage</a></strong>(java.lang.String&nbsp;message,
                        java.lang.String&nbsp;algorithm,
                        char[]&nbsp;privateKeyPassword)</code>
<div class="block">Decrypt message with specified algorithm</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#asymmetricEncryptMessage(java.lang.String, byte[], java.lang.String)">asymmetricEncryptMessage</a></strong>(java.lang.String&nbsp;toUci,
                        byte[]&nbsp;message,
                        java.lang.String&nbsp;algorithm)</code>
<div class="block">Encrypt message with specified algorithm</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#asymmetricEncryptMessage(java.lang.String, java.lang.String, java.lang.String)">asymmetricEncryptMessage</a></strong>(java.lang.String&nbsp;toUci,
                        java.lang.String&nbsp;message,
                        java.lang.String&nbsp;algorithm)</code>
<div class="block">Encrypt message with specified algorithm</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#checkKeyLifetime(java.util.Date, long)">checkKeyLifetime</a></strong>(java.util.Date&nbsp;creationTime,
                long&nbsp;lifeTime)</code>
<div class="block">Check the key is expired or not</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#CreateKeyPairAndCertificate(java.lang.String, char[], char[])">CreateKeyPairAndCertificate</a></strong>(java.lang.String&nbsp;uci,
                           char[]&nbsp;privateKeyPassword,
                           char[]&nbsp;keyStorePassword)</code>
<div class="block">Generate the key pair and self signed certificate</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#decapsulateSecureMessage(se.sensiblethings.disseminationslayer.communication.security.messages.SecureMessage, char[])">decapsulateSecureMessage</a></strong>(<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messages/SecureMessage.html" title="class in se.sensiblethings.disseminationslayer.communication.security.messages">SecureMessage</a>&nbsp;sm,
                        char[]&nbsp;secretKeyPassword)</code>
<div class="block">Decapsulate the secure message by decrypting the payload in this message</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#decryptPayload(byte[], byte[], byte[], java.lang.String)">decryptPayload</a></strong>(byte[]&nbsp;secretKey,
              byte[]&nbsp;iv,
              byte[]&nbsp;payload,
              java.lang.String&nbsp;symmetricMode)</code>
<div class="block">Symmetric decrypt the paylaod with specified mode</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#decryptPayload(java.lang.String, byte[], byte[], java.lang.String, char[])">decryptPayload</a></strong>(java.lang.String&nbsp;fromUci,
              byte[]&nbsp;iv,
              byte[]&nbsp;payload,
              java.lang.String&nbsp;symmetricMode,
              char[]&nbsp;secretkeyPassword)</code>
<div class="block">Symmetric decrypt the paylaod with specified mode</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#digestMessage(java.lang.String, java.lang.String)">digestMessage</a></strong>(java.lang.String&nbsp;message,
             java.lang.String&nbsp;algorithm)</code>
<div class="block">Return the digest of the message</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#encapsulateSecueMessage(java.util.Map, java.lang.String, char[], char[])">encapsulateSecueMessage</a></strong>(java.util.Map&lt;java.lang.String,java.util.Vector&lt;<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messages/SecureMessage.html" title="class in se.sensiblethings.disseminationslayer.communication.security.messages">SecureMessage</a>&gt;&gt;&nbsp;postOffice,
                       java.lang.String&nbsp;toUci,
                       char[]&nbsp;secretKeyPassword,
                       char[]&nbsp;privateKeyPassword)</code>
<div class="block">Encapsulate all secure message with specified receiver, by encrypt the payload context
 and sign the signature of the payload</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#generateSymmetricSecurityKey(java.lang.String, java.lang.String, int, char[], char[])">generateSymmetricSecurityKey</a></strong>(java.lang.String&nbsp;uci,
                            java.lang.String&nbsp;algorithm,
                            int&nbsp;length,
                            char[]&nbsp;secreKeyPassword,
                            char[]&nbsp;keyStorePassword)</code>
<div class="block">Generate the symmetric security key with specified algorithm, key length, and store it</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.security.cert.Certificate</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getCertificate()">getCertificate</a></strong>()</code>
<div class="block">Return itself certificate</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.security.cert.Certificate</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getCertificate(java.lang.String)">getCertificate</a></strong>(java.lang.String&nbsp;uci)</code>
<div class="block">Get the specified certificate with a UCI</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>org.bouncycastle.jce.PKCS10CertificationRequest</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getCertificateSigingRequest(java.lang.String, char[])">getCertificateSigingRequest</a></strong>(java.lang.String&nbsp;uci,
                           char[]&nbsp;privateKeyPassword)</code>
<div class="block">Get the certificate signing request</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.Object</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getFromNoncePool(java.lang.String)">getFromNoncePool</a></strong>(java.lang.String&nbsp;name)</code>
<div class="block">Get the nonce from the pool through specified name</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getIVparameter()">getIVparameter</a></strong>()</code>
<div class="block">Get the instant initialization vector(IV)</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getMyUci()">getMyUci</a></strong>()</code>
<div class="block">Get the UCI of myself</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.security.PublicKey</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getPublicKey()">getPublicKey</a></strong>()</code>
<div class="block">Return the public key of myself</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.security.PublicKey</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getPublicKey(java.lang.String)">getPublicKey</a></strong>(java.lang.String&nbsp;uci)</code>
<div class="block">Return the specified key by UCI</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.security.Key</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#getSecretKey(java.lang.String, char[])">getSecretKey</a></strong>(java.lang.String&nbsp;uci,
            char[]&nbsp;secretKeyPassword)</code>
<div class="block">Get the secret key from the key store</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#hasCertificate(java.lang.String)">hasCertificate</a></strong>(java.lang.String&nbsp;uci)</code>
<div class="block">Check has the specified certificate or not</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#hasSecretKey(java.lang.String)">hasSecretKey</a></strong>(java.lang.String&nbsp;uci)</code>
<div class="block">Check if the key store has the specified secret key</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#initializeKeyStore(java.lang.String, char[], char[])">initializeKeyStore</a></strong>(java.lang.String&nbsp;uci,
                  char[]&nbsp;privateKeyPassword,
                  char[]&nbsp;keyStorePassword)</code>
<div class="block">Initialize the key store: set up or reload the key store file and generate the key pair if it doesn't have</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#isCeritificateSigningRequestValid(org.bouncycastle.jce.PKCS10CertificationRequest, java.lang.String)">isCeritificateSigningRequestValid</a></strong>(org.bouncycastle.jce.PKCS10CertificationRequest&nbsp;certRequest,
                                 java.lang.String&nbsp;fromUci)</code>
<div class="block">Check whether the certificate signing request is valid or not</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#isCertificateValid(java.security.cert.Certificate, java.lang.String)">isCertificateValid</a></strong>(java.security.cert.Certificate&nbsp;cert,
                  java.lang.String&nbsp;fromUci)</code>
<div class="block">Check if the certificate valid not</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#isContactedBefore(java.lang.String)">isContactedBefore</a></strong>(java.lang.String&nbsp;fromUci)</code>
<div class="block">Check whether if it has contacted the sender before</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#isRegisted(java.lang.String, java.lang.String)">isRegisted</a></strong>(java.lang.String&nbsp;myUci,
          java.lang.String&nbsp;bootstrapUci)</code>
<div class="block">Check this UCI has registered or not, by observing the issued certificate</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#isSymmetricKeyValid(java.lang.String, long)">isSymmetricKeyValid</a></strong>(java.lang.String&nbsp;uci,
                   long&nbsp;lifeTime)</code>
<div class="block">Check whether the symmetric key valid of not</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#removeFromNoncePool(java.lang.String)">removeFromNoncePool</a></strong>(java.lang.String&nbsp;name)</code>
<div class="block">Remove the specified nonce from the pool</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#setMyUci(java.lang.String)">setMyUci</a></strong>(java.lang.String&nbsp;myUci)</code>
<div class="block">Set the UCI of myself</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#setSecuiryConfiguraton(se.sensiblethings.disseminationslayer.communication.security.configuration.SecurityConfiguration)">setSecuiryConfiguraton</a></strong>(<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/configuration/SecurityConfiguration.html" title="class in se.sensiblethings.disseminationslayer.communication.security.configuration">SecurityConfiguration</a>&nbsp;config)</code>
<div class="block">Set the security configuration</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.security.cert.Certificate[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#signCertificateSigningRequest(org.bouncycastle.jce.PKCS10CertificationRequest, java.lang.String, char[], char[])">signCertificateSigningRequest</a></strong>(org.bouncycastle.jce.PKCS10CertificationRequest&nbsp;certRequest,
                             java.lang.String&nbsp;uci,
                             char[]&nbsp;privateKeyPassword,
                             char[]&nbsp;keyStorePassword)</code>
<div class="block">Sign the certificate signing request</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#signMessage(byte[], java.lang.String, char[])">signMessage</a></strong>(byte[]&nbsp;message,
           java.lang.String&nbsp;algorithm,
           char[]&nbsp;privateKeyPassword)</code>
<div class="block">Sign the message with specified algorithm</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#signMessage(java.lang.String, java.lang.String, char[])">signMessage</a></strong>(java.lang.String&nbsp;message,
           java.lang.String&nbsp;algorithm,
           char[]&nbsp;privateKeyPassword)</code>
<div class="block">Sign the message with specified algorithm</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#storeCertificate(java.lang.String, java.security.cert.Certificate, char[])">storeCertificate</a></strong>(java.lang.String&nbsp;uci,
                java.security.cert.Certificate&nbsp;cert,
                char[]&nbsp;keyStorePassword)</code>
<div class="block">Store the certificate</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#storeCertificateChain(java.lang.String, java.security.cert.Certificate[], char[], char[])">storeCertificateChain</a></strong>(java.lang.String&nbsp;uci,
                     java.security.cert.Certificate[]&nbsp;certs,
                     char[]&nbsp;privateKeyPassword,
                     char[]&nbsp;keyStorePassword)</code>
<div class="block">Store the certificate chain</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#storePrivateKey(java.lang.String, java.security.PrivateKey, char[], char[], java.security.cert.Certificate[])">storePrivateKey</a></strong>(java.lang.String&nbsp;uci,
               java.security.PrivateKey&nbsp;privateKey,
               char[]&nbsp;privateKeyPassword,
               char[]&nbsp;keyStorePassword,
               java.security.cert.Certificate[]&nbsp;certs)</code>
<div class="block">Store the private key with corresponding certificate chain</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#storeSecretKey(java.lang.String, byte[], java.lang.String, char[], char[])">storeSecretKey</a></strong>(java.lang.String&nbsp;uci,
              byte[]&nbsp;secretKey,
              java.lang.String&nbsp;algorithm,
              char[]&nbsp;secretKeyPassword,
              char[]&nbsp;keyStorePassword)</code>
<div class="block">Store the secret key</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#storeSecretKey(java.lang.String, javax.crypto.SecretKey, char[], char[])">storeSecretKey</a></strong>(java.lang.String&nbsp;uci,
              javax.crypto.SecretKey&nbsp;secretKey,
              char[]&nbsp;secretKeyPassword,
              char[]&nbsp;keyStorePassword)</code>
<div class="block">Store the secret key</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptIVparameter(byte[], byte[])">symmetricDecryptIVparameter</a></strong>(byte[]&nbsp;secretKey,
                           byte[]&nbsp;raw)</code>
<div class="block">Decrypt the initialization vector(IV) with "AES/ECB" mode</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptIVparameter(java.lang.String, byte[], char[])">symmetricDecryptIVparameter</a></strong>(java.lang.String&nbsp;fromUci,
                           byte[]&nbsp;raw,
                           char[]&nbsp;secreKeyPassword)</code>
<div class="block">Decrypt the initialization vector(IV) with "AES/ECB" mode</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptMessage(byte[], byte[], byte[], java.lang.String)">symmetricDecryptMessage</a></strong>(byte[]&nbsp;secretKey,
                       byte[]&nbsp;message,
                       byte[]&nbsp;iv,
                       java.lang.String&nbsp;algorithmModePadding)</code>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptMessage(byte[], byte[], java.lang.String)">symmetricDecryptMessage</a></strong>(byte[]&nbsp;secretKey,
                       byte[]&nbsp;message,
                       java.lang.String&nbsp;algorithmModePadding)</code>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptMessage(javax.crypto.SecretKey, byte[], byte[], java.lang.String)">symmetricDecryptMessage</a></strong>(javax.crypto.SecretKey&nbsp;secretKey,
                       byte[]&nbsp;message,
                       byte[]&nbsp;iv,
                       java.lang.String&nbsp;algorithmModePadding)</code>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptMessage(javax.crypto.SecretKey, byte[], java.lang.String)">symmetricDecryptMessage</a></strong>(javax.crypto.SecretKey&nbsp;secretKey,
                       byte[]&nbsp;message,
                       java.lang.String&nbsp;algorithmModePadding)</code>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptMessage(java.lang.String, byte[], byte[], java.lang.String, char[])">symmetricDecryptMessage</a></strong>(java.lang.String&nbsp;fromUci,
                       byte[]&nbsp;message,
                       byte[]&nbsp;iv,
                       java.lang.String&nbsp;algorithmModePadding,
                       char[]&nbsp;secreKeyPassword)</code>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptMessage(java.lang.String, byte[], java.lang.String, char[])">symmetricDecryptMessage</a></strong>(java.lang.String&nbsp;fromUci,
                       byte[]&nbsp;message,
                       java.lang.String&nbsp;algorithmModePadding,
                       char[]&nbsp;secreKeyPassword)</code>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricDecryptMessage(java.lang.String, java.lang.String, java.lang.String, char[])">symmetricDecryptMessage</a></strong>(java.lang.String&nbsp;fromUci,
                       java.lang.String&nbsp;message,
                       java.lang.String&nbsp;algorithmModePadding,
                       char[]&nbsp;secreKeyPassword)</code>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricEncryptIVParameter(java.lang.String, byte[], char[])">symmetricEncryptIVParameter</a></strong>(java.lang.String&nbsp;toUci,
                           byte[]&nbsp;iv,
                           char[]&nbsp;secreKeyPassword)</code>
<div class="block">Encrypt the initialization vector with "AES/ECB" mode</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricEncryptMessage(java.lang.String, byte[], java.lang.String, char[])">symmetricEncryptMessage</a></strong>(java.lang.String&nbsp;toUci,
                       byte[]&nbsp;message,
                       java.lang.String&nbsp;algorithmModePadding,
                       char[]&nbsp;secreKeyPassword)</code>
<div class="block">Symmetric encrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricEncryptMessage(java.lang.String, java.lang.String, java.lang.String, char[])">symmetricEncryptMessage</a></strong>(java.lang.String&nbsp;toUci,
                       java.lang.String&nbsp;message,
                       java.lang.String&nbsp;algorithmModePadding,
                       char[]&nbsp;secreKeyPassword)</code>
<div class="block">Symmetric encrypt the message with specified algorithm</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private javax.crypto.SecretKey</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#symmetricLoadKey(byte[], java.lang.String)">symmetricLoadKey</a></strong>(byte[]&nbsp;secretKey,
                java.lang.String&nbsp;algorithm)</code>
<div class="block">load the secret key from bytes</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#toX500Name(java.lang.String)">toX500Name</a></strong>(java.lang.String&nbsp;name)</code>
<div class="block">Get the X500Name fromat name from normal UCI name</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#verifySignature(byte[], byte[], java.security.cert.Certificate, java.lang.String)">verifySignature</a></strong>(byte[]&nbsp;message,
               byte[]&nbsp;signature,
               java.security.cert.Certificate&nbsp;cert,
               java.lang.String&nbsp;algorithm)</code>
<div class="block">Verify the signature</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#verifySignature(byte[], byte[], java.security.PublicKey, java.lang.String)">verifySignature</a></strong>(byte[]&nbsp;message,
               byte[]&nbsp;signature,
               java.security.PublicKey&nbsp;publicKey,
               java.lang.String&nbsp;algorithm)</code>
<div class="block">Verify the signature</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#verifySignature(byte[], byte[], java.lang.String, java.lang.String)">verifySignature</a></strong>(byte[]&nbsp;message,
               byte[]&nbsp;signature,
               java.lang.String&nbsp;fromUci,
               java.lang.String&nbsp;algorithm)</code>
<div class="block">Verify the signature</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#verifySignature(java.lang.String, java.lang.String, java.security.cert.Certificate, java.lang.String)">verifySignature</a></strong>(java.lang.String&nbsp;message,
               java.lang.String&nbsp;signature,
               java.security.cert.Certificate&nbsp;cert,
               java.lang.String&nbsp;algorithm)</code>
<div class="block">Verify the signature</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html#verifySignature(java.lang.String, java.lang.String, java.security.PublicKey, java.lang.String)">verifySignature</a></strong>(java.lang.String&nbsp;message,
               java.lang.String&nbsp;signature,
               java.security.PublicKey&nbsp;publicKey,
               java.lang.String&nbsp;algorithm)</code>
<div class="block">Verify the signature</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="myUci">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>myUci</h4>
<pre>private&nbsp;java.lang.String myUci</pre>
</li>
</ul>
<a name="keyStore">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>keyStore</h4>
<pre>private&nbsp;<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/keystore/KeyStoreJCEKS.html" title="class in se.sensiblethings.disseminationslayer.communication.security.keystore">KeyStoreJCEKS</a> keyStore</pre>
</li>
</ul>
<a name="noncePool">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>noncePool</h4>
<pre>private&nbsp;java.util.Map&lt;java.lang.String,java.lang.Object&gt; noncePool</pre>
</li>
</ul>
<a name="config">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>config</h4>
<pre>private&nbsp;<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/configuration/SecurityConfiguration.html" title="class in se.sensiblethings.disseminationslayer.communication.security.configuration">SecurityConfiguration</a> config</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="SecurityManager(se.sensiblethings.disseminationslayer.communication.security.configuration.SecurityConfiguration)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>SecurityManager</h4>
<pre>public&nbsp;SecurityManager(<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/configuration/SecurityConfiguration.html" title="class in se.sensiblethings.disseminationslayer.communication.security.configuration">SecurityConfiguration</a>&nbsp;config)</pre>
<div class="block">Initialize the security manager</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>config</code> - the security configuration</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="initializeKeyStore(java.lang.String, char[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initializeKeyStore</h4>
<pre>public&nbsp;void&nbsp;initializeKeyStore(java.lang.String&nbsp;uci,
                      char[]&nbsp;privateKeyPassword,
                      char[]&nbsp;keyStorePassword)</pre>
<div class="block">Initialize the key store: set up or reload the key store file and generate the key pair if it doesn't have</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - UCI of myself</dd><dd><code>privateKeyPassword</code> - password to protect the private key</dd><dd><code>keyStorePassword</code> - password to protect the key store</dd></dl>
</li>
</ul>
<a name="setSecuiryConfiguraton(se.sensiblethings.disseminationslayer.communication.security.configuration.SecurityConfiguration)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setSecuiryConfiguraton</h4>
<pre>public&nbsp;void&nbsp;setSecuiryConfiguraton(<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/configuration/SecurityConfiguration.html" title="class in se.sensiblethings.disseminationslayer.communication.security.configuration">SecurityConfiguration</a>&nbsp;config)</pre>
<div class="block">Set the security configuration</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>config</code> - the security configuration</dd></dl>
</li>
</ul>
<a name="getMyUci()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMyUci</h4>
<pre>public&nbsp;java.lang.String&nbsp;getMyUci()</pre>
<div class="block">Get the UCI of myself</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>return the UCI of myself</dd></dl>
</li>
</ul>
<a name="setMyUci(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMyUci</h4>
<pre>public&nbsp;void&nbsp;setMyUci(java.lang.String&nbsp;myUci)</pre>
<div class="block">Set the UCI of myself</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>myUci</code> - set the UCI of myself</dd></dl>
</li>
</ul>
<a name="addToNoncePool(java.lang.String, java.lang.Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addToNoncePool</h4>
<pre>public&nbsp;void&nbsp;addToNoncePool(java.lang.String&nbsp;name,
                  java.lang.Object&nbsp;value)</pre>
<div class="block">Add the nonce to the temporary pool</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>name</code> - the name mapping to this nonce</dd><dd><code>value</code> - the value of this nonce, maybe a integer or a time stamp</dd></dl>
</li>
</ul>
<a name="getFromNoncePool(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFromNoncePool</h4>
<pre>public&nbsp;java.lang.Object&nbsp;getFromNoncePool(java.lang.String&nbsp;name)</pre>
<div class="block">Get the nonce from the pool through specified name</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>name</code> - the name mapping to this nonce</dd>
<dt><span class="strong">Returns:</span></dt><dd>return the value of the nonce</dd></dl>
</li>
</ul>
<a name="removeFromNoncePool(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeFromNoncePool</h4>
<pre>public&nbsp;boolean&nbsp;removeFromNoncePool(java.lang.String&nbsp;name)</pre>
<div class="block">Remove the specified nonce from the pool</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>name</code> - the name mapping to this nonce</dd>
<dt><span class="strong">Returns:</span></dt><dd>return true if removed successfully, false if no such nonce</dd></dl>
</li>
</ul>
<a name="isSymmetricKeyValid(java.lang.String, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isSymmetricKeyValid</h4>
<pre>public&nbsp;boolean&nbsp;isSymmetricKeyValid(java.lang.String&nbsp;uci,
                          long&nbsp;lifeTime)</pre>
<div class="block">Check whether the symmetric key valid of not</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI mapping to this key</dd><dd><code>lifeTime</code> - the life time of the key</dd>
<dt><span class="strong">Returns:</span></dt><dd>return true if this key is valid, false if there is no such key in key store or this key is expired.</dd></dl>
</li>
</ul>
<a name="checkKeyLifetime(java.util.Date, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkKeyLifetime</h4>
<pre>private&nbsp;boolean&nbsp;checkKeyLifetime(java.util.Date&nbsp;creationTime,
                       long&nbsp;lifeTime)</pre>
<div class="block">Check the key is expired or not</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>creationTime</code> - the time when the key was stored</dd><dd><code>lifeTime</code> - the life time of the key</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this key is not expired, otherwise false</dd></dl>
</li>
</ul>
<a name="isRegisted(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isRegisted</h4>
<pre>public&nbsp;boolean&nbsp;isRegisted(java.lang.String&nbsp;myUci,
                 java.lang.String&nbsp;bootstrapUci)</pre>
<div class="block">Check this UCI has registered or not, by observing the issued certificate</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>myUci</code> - the UCI to be checked</dd><dd><code>bootstrapUci</code> - the UCI of Bootstrap node</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if it has registered, false it hasn't</dd></dl>
</li>
</ul>
<a name="decapsulateSecureMessage(se.sensiblethings.disseminationslayer.communication.security.messages.SecureMessage, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decapsulateSecureMessage</h4>
<pre>public&nbsp;byte[]&nbsp;decapsulateSecureMessage(<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messages/SecureMessage.html" title="class in se.sensiblethings.disseminationslayer.communication.security.messages">SecureMessage</a>&nbsp;sm,
                              char[]&nbsp;secretKeyPassword)</pre>
<div class="block">Decapsulate the secure message by decrypting the payload in this message</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>sm</code> - the secure message to be operated</dd><dd><code>secretKeyPassword</code> - the password to get the secret key from the key store</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain context in payload</dd></dl>
</li>
</ul>
<a name="encapsulateSecueMessage(java.util.Map, java.lang.String, char[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encapsulateSecueMessage</h4>
<pre>public&nbsp;void&nbsp;encapsulateSecueMessage(java.util.Map&lt;java.lang.String,java.util.Vector&lt;<a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messages/SecureMessage.html" title="class in se.sensiblethings.disseminationslayer.communication.security.messages">SecureMessage</a>&gt;&gt;&nbsp;postOffice,
                           java.lang.String&nbsp;toUci,
                           char[]&nbsp;secretKeyPassword,
                           char[]&nbsp;privateKeyPassword)</pre>
<div class="block">Encapsulate all secure message with specified receiver, by encrypt the payload context
 and sign the signature of the payload</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>postOffice</code> - the post office where temporarily store the up going messages</dd><dd><code>toUci</code> - the UCI of the receiver</dd><dd><code>secretKeyPassword</code> - the password to get the secret key</dd><dd><code>privateKeyPassword</code> - the password to get the private key</dd></dl>
</li>
</ul>
<a name="CreateKeyPairAndCertificate(java.lang.String, char[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CreateKeyPairAndCertificate</h4>
<pre>protected&nbsp;void&nbsp;CreateKeyPairAndCertificate(java.lang.String&nbsp;uci,
                               char[]&nbsp;privateKeyPassword,
                               char[]&nbsp;keyStorePassword)</pre>
<div class="block">Generate the key pair and self signed certificate</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI of myself</dd><dd><code>privateKeyPassword</code> - the password to protect the private key</dd><dd><code>keyStorePassword</code> - the password to protect the key store</dd></dl>
</li>
</ul>
<a name="isCeritificateSigningRequestValid(org.bouncycastle.jce.PKCS10CertificationRequest, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isCeritificateSigningRequestValid</h4>
<pre>public&nbsp;boolean&nbsp;isCeritificateSigningRequestValid(org.bouncycastle.jce.PKCS10CertificationRequest&nbsp;certRequest,
                                        java.lang.String&nbsp;fromUci)</pre>
<div class="block">Check whether the certificate signing request is valid or not</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>certRequest</code> - the certificate signing request to be checked</dd><dd><code>fromUci</code> - the sender of this request</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this request valid, false not</dd></dl>
</li>
</ul>
<a name="isCertificateValid(java.security.cert.Certificate, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isCertificateValid</h4>
<pre>public&nbsp;boolean&nbsp;isCertificateValid(java.security.cert.Certificate&nbsp;cert,
                         java.lang.String&nbsp;fromUci)</pre>
<div class="block">Check if the certificate valid not</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>cert</code> - the certificate to be checked</dd><dd><code>fromUci</code> - the UCI who owns the certificate</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this certificate is valid, false not</dd></dl>
</li>
</ul>
<a name="toX500Name(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toX500Name</h4>
<pre>private&nbsp;java.lang.String&nbsp;toX500Name(java.lang.String&nbsp;name)</pre>
<div class="block">Get the X500Name fromat name from normal UCI name</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>name</code> - the normal UCI name</dd>
<dt><span class="strong">Returns:</span></dt><dd>the X500Name format name</dd></dl>
</li>
</ul>
<a name="isContactedBefore(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isContactedBefore</h4>
<pre>public&nbsp;boolean&nbsp;isContactedBefore(java.lang.String&nbsp;fromUci)</pre>
<div class="block">Check whether if it has contacted the sender before</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fromUci</code> - the UCI of the sender</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if the key store has the UCI of the sender, otherwise false</dd></dl>
</li>
</ul>
<a name="signCertificateSigningRequest(org.bouncycastle.jce.PKCS10CertificationRequest, java.lang.String, char[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>signCertificateSigningRequest</h4>
<pre>public&nbsp;java.security.cert.Certificate[]&nbsp;signCertificateSigningRequest(org.bouncycastle.jce.PKCS10CertificationRequest&nbsp;certRequest,
                                                             java.lang.String&nbsp;uci,
                                                             char[]&nbsp;privateKeyPassword,
                                                             char[]&nbsp;keyStorePassword)</pre>
<div class="block">Sign the certificate signing request</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>certRequest</code> - the certificate signing request</dd><dd><code>uci</code> - the UCI who sends the request</dd><dd><code>privateKeyPassword</code> - the password to get the private key</dd><dd><code>keyStorePassword</code> - the password to protect the key store</dd>
<dt><span class="strong">Returns:</span></dt><dd>the certificate chain including the issued certificate by Bootstrap and Bootstrap's root certificate</dd></dl>
</li>
</ul>
<a name="getCertificate()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCertificate</h4>
<pre>public&nbsp;java.security.cert.Certificate&nbsp;getCertificate()</pre>
<div class="block">Return itself certificate</p>
 
 Before registration to the bootstrap, it retrieves the self signed root certificate
 with X509V1 version. Otherwise, it retrieves the bootstrap issued certificate from the 
 certificate chain in the keystore's <code>PrivateKeyEntry</code>. It is the first certificate
 in this certificate chain.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>Certificate itself certificate</dd></dl>
</li>
</ul>
<a name="getCertificate(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCertificate</h4>
<pre>public&nbsp;java.security.cert.Certificate&nbsp;getCertificate(java.lang.String&nbsp;uci)</pre>
<div class="block">Get the specified certificate with a UCI</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI specifying the certificate</dd>
<dt><span class="strong">Returns:</span></dt><dd>the specified certificate</dd></dl>
</li>
</ul>
<a name="hasCertificate(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasCertificate</h4>
<pre>public&nbsp;boolean&nbsp;hasCertificate(java.lang.String&nbsp;uci)</pre>
<div class="block">Check has the specified certificate or not</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI specifying the certificate</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this key store has the specified certificate, otherwise false</dd></dl>
</li>
</ul>
<a name="getCertificateSigingRequest(java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCertificateSigingRequest</h4>
<pre>public&nbsp;org.bouncycastle.jce.PKCS10CertificationRequest&nbsp;getCertificateSigingRequest(java.lang.String&nbsp;uci,
                                                                          char[]&nbsp;privateKeyPassword)</pre>
<div class="block">Get the certificate signing request</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI who want to send the certificate</dd><dd><code>privateKeyPassword</code> - the password to get the private key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the certificate signing request</dd></dl>
</li>
</ul>
<a name="storeCertificateChain(java.lang.String, java.security.cert.Certificate[], char[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storeCertificateChain</h4>
<pre>public&nbsp;void&nbsp;storeCertificateChain(java.lang.String&nbsp;uci,
                         java.security.cert.Certificate[]&nbsp;certs,
                         char[]&nbsp;privateKeyPassword,
                         char[]&nbsp;keyStorePassword)</pre>
<div class="block">Store the certificate chain</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI of myself</dd><dd><code>certs</code> - the certificate chain to be stored</dd><dd><code>privateKeyPassword</code> - the password to protect the private key</dd><dd><code>keyStorePassword</code> - the password to protect the key store</dd></dl>
</li>
</ul>
<a name="storePrivateKey(java.lang.String, java.security.PrivateKey, char[], char[], java.security.cert.Certificate[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storePrivateKey</h4>
<pre>public&nbsp;void&nbsp;storePrivateKey(java.lang.String&nbsp;uci,
                   java.security.PrivateKey&nbsp;privateKey,
                   char[]&nbsp;privateKeyPassword,
                   char[]&nbsp;keyStorePassword,
                   java.security.cert.Certificate[]&nbsp;certs)</pre>
<div class="block">Store the private key with corresponding certificate chain</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI of myself</dd><dd><code>privateKey</code> - the private key to be stored</dd><dd><code>privateKeyPassword</code> - the password to protect the private key</dd><dd><code>keyStorePassword</code> - the password to protect the key store</dd><dd><code>certs</code> - the corresponding certificate chain</dd></dl>
</li>
</ul>
<a name="storeCertificate(java.lang.String, java.security.cert.Certificate, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storeCertificate</h4>
<pre>public&nbsp;void&nbsp;storeCertificate(java.lang.String&nbsp;uci,
                    java.security.cert.Certificate&nbsp;cert,
                    char[]&nbsp;keyStorePassword)</pre>
<div class="block">Store the certificate</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI of own the certificate</dd><dd><code>cert</code> - the certificate to be stored</dd><dd><code>keyStorePassword</code> - the password to protect the key store</dd></dl>
</li>
</ul>
<a name="signMessage(java.lang.String, java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>signMessage</h4>
<pre>public&nbsp;java.lang.String&nbsp;signMessage(java.lang.String&nbsp;message,
                           java.lang.String&nbsp;algorithm,
                           char[]&nbsp;privateKeyPassword)</pre>
<div class="block">Sign the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be signed</dd><dd><code>algorithm</code> - the specified algorithm</dd><dd><code>privateKeyPassword</code> - the password to protect the private key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the signature of the message in string type</dd></dl>
</li>
</ul>
<a name="signMessage(byte[], java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>signMessage</h4>
<pre>public&nbsp;byte[]&nbsp;signMessage(byte[]&nbsp;message,
                 java.lang.String&nbsp;algorithm,
                 char[]&nbsp;privateKeyPassword)</pre>
<div class="block">Sign the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be signed</dd><dd><code>algorithm</code> - the specified algorithm</dd><dd><code>privateKeyPassword</code> - the password to protect the private key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the signature of the message in bytes</dd></dl>
</li>
</ul>
<a name="verifySignature(byte[], byte[], java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignature</h4>
<pre>public&nbsp;boolean&nbsp;verifySignature(byte[]&nbsp;message,
                      byte[]&nbsp;signature,
                      java.lang.String&nbsp;fromUci,
                      java.lang.String&nbsp;algorithm)</pre>
<div class="block">Verify the signature</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the source message</dd><dd><code>signature</code> - the corresponding signature to be checked</dd><dd><code>fromUci</code> - the UCI who sign the message</dd><dd><code>algorithm</code> - the algorithm used for this signature</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this signature is valid, otherwise false</dd></dl>
</li>
</ul>
<a name="verifySignature(byte[], byte[], java.security.PublicKey, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignature</h4>
<pre>public&nbsp;boolean&nbsp;verifySignature(byte[]&nbsp;message,
                      byte[]&nbsp;signature,
                      java.security.PublicKey&nbsp;publicKey,
                      java.lang.String&nbsp;algorithm)</pre>
<div class="block">Verify the signature</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the source message in bytes</dd><dd><code>signature</code> - the corresponding signature to be checked</dd><dd><code>publicKey</code> - the public key that could be used for verifying</dd><dd><code>algorithm</code> - the algorithm used for this signature</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this signature is valid, otherwise false</dd></dl>
</li>
</ul>
<a name="verifySignature(java.lang.String, java.lang.String, java.security.PublicKey, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignature</h4>
<pre>public&nbsp;boolean&nbsp;verifySignature(java.lang.String&nbsp;message,
                      java.lang.String&nbsp;signature,
                      java.security.PublicKey&nbsp;publicKey,
                      java.lang.String&nbsp;algorithm)</pre>
<div class="block">Verify the signature</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the source message in String type</dd><dd><code>signature</code> - the corresponding signature to be checked</dd><dd><code>publicKey</code> - the public key that could be used for verifying</dd><dd><code>algorithm</code> - the algorithm used for this signature</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this signature is valid, otherwise false</dd></dl>
</li>
</ul>
<a name="verifySignature(byte[], byte[], java.security.cert.Certificate, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignature</h4>
<pre>public&nbsp;boolean&nbsp;verifySignature(byte[]&nbsp;message,
                      byte[]&nbsp;signature,
                      java.security.cert.Certificate&nbsp;cert,
                      java.lang.String&nbsp;algorithm)</pre>
<div class="block">Verify the signature</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the source message in String type</dd><dd><code>signature</code> - the corresponding signature in bytes to be checked</dd><dd><code>cert</code> - the certificate containing the public key that could be used for verifying</dd><dd><code>algorithm</code> - the algorithm used for this signature</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this signature is valid, otherwise false</dd></dl>
</li>
</ul>
<a name="verifySignature(java.lang.String, java.lang.String, java.security.cert.Certificate, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>verifySignature</h4>
<pre>public&nbsp;boolean&nbsp;verifySignature(java.lang.String&nbsp;message,
                      java.lang.String&nbsp;signature,
                      java.security.cert.Certificate&nbsp;cert,
                      java.lang.String&nbsp;algorithm)</pre>
<div class="block">Verify the signature</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the source message in String type</dd><dd><code>signature</code> - the corresponding signature in String type to be checked</dd><dd><code>cert</code> - the certificate containing the public key that could be used for verifying</dd><dd><code>algorithm</code> - the algorithm used for this signature</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if this signature is valid, otherwise false</dd></dl>
</li>
</ul>
<a name="asymmetricEncryptMessage(java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>asymmetricEncryptMessage</h4>
<pre>public&nbsp;java.lang.String&nbsp;asymmetricEncryptMessage(java.lang.String&nbsp;toUci,
                                        java.lang.String&nbsp;message,
                                        java.lang.String&nbsp;algorithm)</pre>
<div class="block">Encrypt message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be encrypt</dd><dd><code>algorithm</code> - the specified encryption algorithm</dd>
<dt><span class="strong">Returns:</span></dt><dd>the cipher text in String type</dd></dl>
</li>
</ul>
<a name="asymmetricEncryptMessage(java.lang.String, byte[], java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>asymmetricEncryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;asymmetricEncryptMessage(java.lang.String&nbsp;toUci,
                              byte[]&nbsp;message,
                              java.lang.String&nbsp;algorithm)</pre>
<div class="block">Encrypt message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>toUci</code> - the receiver who to send this message to</dd><dd><code>message</code> - the message to be encrypt</dd><dd><code>algorithm</code> - the specified encryption algorithm</dd>
<dt><span class="strong">Returns:</span></dt><dd>the cipher text in bytes</dd></dl>
</li>
</ul>
<a name="asymmetricDecryptMessage(java.lang.String, java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>asymmetricDecryptMessage</h4>
<pre>public&nbsp;java.lang.String&nbsp;asymmetricDecryptMessage(java.lang.String&nbsp;message,
                                        java.lang.String&nbsp;algorithm,
                                        char[]&nbsp;privateKeyPassword)</pre>
<div class="block">Decrypt message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be decrypt</dd><dd><code>algorithm</code> - the specified algorithm</dd><dd><code>privateKeyPassword</code> - the password protecting the private key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text in string type</dd></dl>
</li>
</ul>
<a name="asymmetricDecryptMessage(byte[], java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>asymmetricDecryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;asymmetricDecryptMessage(byte[]&nbsp;message,
                              java.lang.String&nbsp;algorithm,
                              char[]&nbsp;privateKeyPassword)</pre>
<div class="block">Decrypt message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be decrypt</dd><dd><code>algorithm</code> - the specified algorithm</dd><dd><code>privateKeyPassword</code> - the password protecting the private key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text in bytes</dd></dl>
</li>
</ul>
<a name="getPublicKey()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPublicKey</h4>
<pre>public&nbsp;java.security.PublicKey&nbsp;getPublicKey()</pre>
<div class="block">Return the public key of myself</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>Return the public key of myself</dd></dl>
</li>
</ul>
<a name="getPublicKey(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPublicKey</h4>
<pre>public&nbsp;java.security.PublicKey&nbsp;getPublicKey(java.lang.String&nbsp;uci)</pre>
<div class="block">Return the specified key by UCI</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCi specifying the the key</dd>
<dt><span class="strong">Returns:</span></dt><dd>Return the specified key by UCI</dd></dl>
</li>
</ul>
<a name="decryptPayload(byte[], byte[], byte[], java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decryptPayload</h4>
<pre>public&nbsp;byte[]&nbsp;decryptPayload(byte[]&nbsp;secretKey,
                    byte[]&nbsp;iv,
                    byte[]&nbsp;payload,
                    java.lang.String&nbsp;symmetricMode)</pre>
<div class="block">Symmetric decrypt the paylaod with specified mode</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>secretKey</code> - the key to decrypt the payload</dd><dd><code>iv</code> - the initialization vector</dd><dd><code>payload</code> - the payload in bytes to be decrypt</dd><dd><code>symmetricMode</code> - the symmetric cipher mode</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain context of the payload</dd></dl>
</li>
</ul>
<a name="decryptPayload(java.lang.String, byte[], byte[], java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decryptPayload</h4>
<pre>public&nbsp;byte[]&nbsp;decryptPayload(java.lang.String&nbsp;fromUci,
                    byte[]&nbsp;iv,
                    byte[]&nbsp;payload,
                    java.lang.String&nbsp;symmetricMode,
                    char[]&nbsp;secretkeyPassword)</pre>
<div class="block">Symmetric decrypt the paylaod with specified mode</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fromUci</code> - the UCI who sends the message</dd><dd><code>iv</code> - the initialization vector</dd><dd><code>payload</code> - the payload in bytes to be decrypt</dd><dd><code>symmetricMode</code> - the symmetric cipher mode</dd><dd><code>secretkeyPassword</code> - the password protecting the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain context of the payload</dd></dl>
</li>
</ul>
<a name="symmetricEncryptIVParameter(java.lang.String, byte[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricEncryptIVParameter</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricEncryptIVParameter(java.lang.String&nbsp;toUci,
                                 byte[]&nbsp;iv,
                                 char[]&nbsp;secreKeyPassword)</pre>
<div class="block">Encrypt the initialization vector with "AES/ECB" mode</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>toUci</code> - the UCI who sends to</dd><dd><code>iv</code> - the initialization vector</dd><dd><code>secreKeyPassword</code> - the password protecting the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the cipher text of the IV in bytes</dd></dl>
</li>
</ul>
<a name="symmetricDecryptIVparameter(java.lang.String, byte[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptIVparameter</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricDecryptIVparameter(java.lang.String&nbsp;fromUci,
                                 byte[]&nbsp;raw,
                                 char[]&nbsp;secreKeyPassword)</pre>
<div class="block">Decrypt the initialization vector(IV) with "AES/ECB" mode</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fromUci</code> - the UCI who sends from</dd><dd><code>raw</code> - the cipher text of the IV</dd><dd><code>secreKeyPassword</code> - the password protecting the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the IV in bytes</dd></dl>
</li>
</ul>
<a name="symmetricDecryptIVparameter(byte[], byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptIVparameter</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricDecryptIVparameter(byte[]&nbsp;secretKey,
                                 byte[]&nbsp;raw)</pre>
<div class="block">Decrypt the initialization vector(IV) with "AES/ECB" mode</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>secretKey</code> - the key used to decrypt the IV</dd><dd><code>raw</code> - the cipher text of the IV</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the IV in bytes</dd></dl>
</li>
</ul>
<a name="getIVparameter()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getIVparameter</h4>
<pre>public&nbsp;byte[]&nbsp;getIVparameter()</pre>
<div class="block">Get the instant initialization vector(IV)</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the instant initialization vector(IV)</dd></dl>
</li>
</ul>
<a name="symmetricEncryptMessage(java.lang.String, java.lang.String, java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricEncryptMessage</h4>
<pre>public&nbsp;java.lang.String&nbsp;symmetricEncryptMessage(java.lang.String&nbsp;toUci,
                                       java.lang.String&nbsp;message,
                                       java.lang.String&nbsp;algorithmModePadding,
                                       char[]&nbsp;secreKeyPassword)</pre>
<div class="block">Symmetric encrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>toUci</code> - the message who sends to</dd><dd><code>message</code> - the message to be encrypt</dd><dd><code>algorithmModePadding</code> - encryption algorithm, mode and padding</dd><dd><code>secreKeyPassword</code> - the password protecting the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the cipher text of the message in string type</dd></dl>
</li>
</ul>
<a name="symmetricEncryptMessage(java.lang.String, byte[], java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricEncryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricEncryptMessage(java.lang.String&nbsp;toUci,
                             byte[]&nbsp;message,
                             java.lang.String&nbsp;algorithmModePadding,
                             char[]&nbsp;secreKeyPassword)</pre>
<div class="block">Symmetric encrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>toUci</code> - the message who sends to</dd><dd><code>message</code> - the message to be encrypt</dd><dd><code>algorithmModePadding</code> - encryption algorithm, mode and padding</dd><dd><code>secreKeyPassword</code> - the password protecting the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the cipher text of the message in bytes</dd></dl>
</li>
</ul>
<a name="symmetricDecryptMessage(java.lang.String, java.lang.String, java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptMessage</h4>
<pre>public&nbsp;java.lang.String&nbsp;symmetricDecryptMessage(java.lang.String&nbsp;fromUci,
                                       java.lang.String&nbsp;message,
                                       java.lang.String&nbsp;algorithmModePadding,
                                       char[]&nbsp;secreKeyPassword)</pre>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fromUci</code> - the message who sends from</dd><dd><code>message</code> - the message to be decrypt</dd><dd><code>algorithmModePadding</code> - encryption algorithm, mode and padding</dd><dd><code>secreKeyPassword</code> - the password protecting the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the message in bytes</dd></dl>
</li>
</ul>
<a name="symmetricDecryptMessage(javax.crypto.SecretKey, byte[], java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricDecryptMessage(javax.crypto.SecretKey&nbsp;secretKey,
                             byte[]&nbsp;message,
                             java.lang.String&nbsp;algorithmModePadding)</pre>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>secretKey</code> - the secret key used to decrypt the message</dd><dd><code>message</code> - the message to be decrypt</dd><dd><code>algorithmModePadding</code> - encryption algorithm, mode and padding</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the message in bytes</dd></dl>
</li>
</ul>
<a name="symmetricDecryptMessage(java.lang.String, byte[], java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricDecryptMessage(java.lang.String&nbsp;fromUci,
                             byte[]&nbsp;message,
                             java.lang.String&nbsp;algorithmModePadding,
                             char[]&nbsp;secreKeyPassword)</pre>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fromUci</code> - the message who sends from</dd><dd><code>message</code> - the message to be decrypt</dd><dd><code>algorithmModePadding</code> - encryption algorithm, mode and padding</dd><dd><code>secreKeyPassword</code> - the password protecting the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the message in bytes</dd></dl>
</li>
</ul>
<a name="symmetricDecryptMessage(byte[], byte[], java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricDecryptMessage(byte[]&nbsp;secretKey,
                             byte[]&nbsp;message,
                             java.lang.String&nbsp;algorithmModePadding)</pre>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>secretKey</code> - the secret key used to decrypt the message</dd><dd><code>message</code> - the message to be decrypt</dd><dd><code>algorithmModePadding</code> - decryption algorithm, mode and padding</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the message in bytes</dd></dl>
</li>
</ul>
<a name="symmetricLoadKey(byte[], java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricLoadKey</h4>
<pre>private&nbsp;javax.crypto.SecretKey&nbsp;symmetricLoadKey(byte[]&nbsp;secretKey,
                                      java.lang.String&nbsp;algorithm)</pre>
<div class="block">load the secret key from bytes</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>secretKey</code> - the secret key in bytes</dd><dd><code>algorithm</code> - the corresponding algorithm used for with this key</dd>
<dt><span class="strong">Returns:</span></dt><dd>a instance of the secret key</dd></dl>
</li>
</ul>
<a name="symmetricDecryptMessage(javax.crypto.SecretKey, byte[], byte[], java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricDecryptMessage(javax.crypto.SecretKey&nbsp;secretKey,
                             byte[]&nbsp;message,
                             byte[]&nbsp;iv,
                             java.lang.String&nbsp;algorithmModePadding)</pre>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>secretKey</code> - the secret key used to decrypt the message</dd><dd><code>message</code> - the message to be decrypt</dd><dd><code>iv</code> - the initialization vector</dd><dd><code>algorithmModePadding</code> - decryption algorithm, mode and padding</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the message in bytes</dd></dl>
</li>
</ul>
<a name="symmetricDecryptMessage(java.lang.String, byte[], byte[], java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricDecryptMessage(java.lang.String&nbsp;fromUci,
                             byte[]&nbsp;message,
                             byte[]&nbsp;iv,
                             java.lang.String&nbsp;algorithmModePadding,
                             char[]&nbsp;secreKeyPassword)</pre>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fromUci</code> - the message who sends from</dd><dd><code>message</code> - the message to be decrypt</dd><dd><code>iv</code> - the initialization vector</dd><dd><code>algorithmModePadding</code> - decryption algorithm, mode and padding</dd><dd><code>secreKeyPassword</code> - the password protecting the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the message in bytes</dd></dl>
</li>
</ul>
<a name="symmetricDecryptMessage(byte[], byte[], byte[], java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>symmetricDecryptMessage</h4>
<pre>public&nbsp;byte[]&nbsp;symmetricDecryptMessage(byte[]&nbsp;secretKey,
                             byte[]&nbsp;message,
                             byte[]&nbsp;iv,
                             java.lang.String&nbsp;algorithmModePadding)</pre>
<div class="block">Symmetric decrypt the message with specified algorithm</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>secretKey</code> - the secret key used to decrypt the message</dd><dd><code>message</code> - the message to be decrypt</dd><dd><code>iv</code> - the initialization vector</dd><dd><code>algorithmModePadding</code> - decryption algorithm, mode and padding</dd>
<dt><span class="strong">Returns:</span></dt><dd>the plain text of the message in bytes</dd></dl>
</li>
</ul>
<a name="generateSymmetricSecurityKey(java.lang.String, java.lang.String, int, char[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateSymmetricSecurityKey</h4>
<pre>public&nbsp;boolean&nbsp;generateSymmetricSecurityKey(java.lang.String&nbsp;uci,
                                   java.lang.String&nbsp;algorithm,
                                   int&nbsp;length,
                                   char[]&nbsp;secreKeyPassword,
                                   char[]&nbsp;keyStorePassword)</pre>
<div class="block">Generate the symmetric security key with specified algorithm, key length, and store it</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI who shares this secret key together</dd><dd><code>algorithm</code> - the algorithm used for this key</dd><dd><code>length</code> - the key length</dd><dd><code>secreKeyPassword</code> - the password protecting the secret key</dd><dd><code>keyStorePassword</code> - the password protecting the key store</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if generating and storing of the secret key successfully, otherwise false</dd></dl>
</li>
</ul>
<a name="storeSecretKey(java.lang.String, javax.crypto.SecretKey, char[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storeSecretKey</h4>
<pre>public&nbsp;void&nbsp;storeSecretKey(java.lang.String&nbsp;uci,
                  javax.crypto.SecretKey&nbsp;secretKey,
                  char[]&nbsp;secretKeyPassword,
                  char[]&nbsp;keyStorePassword)</pre>
<div class="block">Store the secret key</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the secret key who share with</dd><dd><code>secretKey</code> - the secret key</dd><dd><code>secretKeyPassword</code> - the password protecting the secret key</dd><dd><code>keyStorePassword</code> - the password protecting the key store</dd></dl>
</li>
</ul>
<a name="storeSecretKey(java.lang.String, byte[], java.lang.String, char[], char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storeSecretKey</h4>
<pre>public&nbsp;void&nbsp;storeSecretKey(java.lang.String&nbsp;uci,
                  byte[]&nbsp;secretKey,
                  java.lang.String&nbsp;algorithm,
                  char[]&nbsp;secretKeyPassword,
                  char[]&nbsp;keyStorePassword)</pre>
<div class="block">Store the secret key</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the secret key who share with</dd><dd><code>secretKey</code> - the secret key in bytes</dd><dd><code>algorithm</code> - the algorithm used for this key</dd><dd><code>secretKeyPassword</code> - the password protecting the secret key</dd><dd><code>keyStorePassword</code> - the password protecting the key store</dd></dl>
</li>
</ul>
<a name="getSecretKey(java.lang.String, char[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSecretKey</h4>
<pre>public&nbsp;java.security.Key&nbsp;getSecretKey(java.lang.String&nbsp;uci,
                             char[]&nbsp;secretKeyPassword)</pre>
<div class="block">Get the secret key from the key store</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI specifying the secret key</dd><dd><code>secretKeyPassword</code> - the password to get the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>the secret key from the key store</dd></dl>
</li>
</ul>
<a name="hasSecretKey(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasSecretKey</h4>
<pre>public&nbsp;boolean&nbsp;hasSecretKey(java.lang.String&nbsp;uci)</pre>
<div class="block">Check if the key store has the specified secret key</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>uci</code> - the UCI specifying the secret key</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if the key store has, otherwise false</dd></dl>
</li>
</ul>
<a name="digestMessage(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>digestMessage</h4>
<pre>public&nbsp;java.lang.String&nbsp;digestMessage(java.lang.String&nbsp;message,
                             java.lang.String&nbsp;algorithm)</pre>
<div class="block">Return the digest of the message</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message where the digest gets from</dd><dd><code>algorithm</code> - the digest algorithm</dd>
<dt><span class="strong">Returns:</span></dt><dd>the digest of the message</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/SecurityManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../se/sensiblethings/disseminationslayer/communication/security/messagehandler/MessageHandler.html" title="class in se.sensiblethings.disseminationslayer.communication.security.messagehandler"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?se/sensiblethings/disseminationslayer/communication/security/messagehandler/SecurityManager.html" target="_top">Frames</a></li>
<li><a href="SecurityManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
